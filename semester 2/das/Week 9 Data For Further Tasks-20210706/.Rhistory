x
#d
x=gen.gamma(1000,47,26)
x
for(i in 1:1000){
x[i]=gen.gamma.once(1000,mu,sigma)
}
for(i in 1:1000){
x[i]=gen.gamma(1000,47,26)
}
x
#d
x=gen.gamma(1000,47,26)
x
#10
#a
f=function(x,a,b){
(b^a)*(gamma(a))^(-1)*x^(a-1)*exp(-b*x)
}
#b
g=function(x,lambda){
lambda*exp(-lambda*x)
}
gen.gamma.once=function(n,mu,sigma){ #auxiliary function
x=numeric(n)
a=mu^2/sigma^2 #1
b=mu/sigma^2
lambda=b/a #2
x.star=a/b
c=f(x.star,a,b)/g(x.star,lambda) #3
while(TRUE){
y=rexp(1, rate = lambda) #4.1
u=runif(1) #4.2
alpha=f(y,a,b)/(c*g(y,lambda)) #4.3
if(u<alpha) break
}
x=y #4.4
}
#d
x=gen.gamma.once(1000,47,26)
for(i in 1:1000){
x[i]=gen.gamma.once(1000,47,26)
}
for(i in 1:1000){
x[i]=gen.gamma.once(1000,47,26)
}
x
gen.gamma=function(n,mu,sigma){ #gen.gamma
x=numeric(n)
for(i in 1:n){
x[i]=gen.gamma.once(n,mu,sigma)
}
}
#d
x=gen.gamma(1000,47,26)
gen.gamma=function(n,mu,sigma){ #gen.gamma
x=numeric(n)
ntimes=n
for(i in 1:ntimes){
x[i]=gen.gamma.once(n,mu,sigma)
}
}
gen.gamma=function(n,mu,sigma){ #gen.gamma
x=numeric(n)
ntimes=n
for(i in 1:ntimes){
x[i]=gen.gamma.once(n,mu,sigma)
}
}
#d
x=gen.gamma(1000,47,26)
#succeed
for(i in 1:1000){
x[i]=gen.gamma.once(1000,47,26)
}
#or
for(i in 1:1000){
x[i]=gen.gamma.once(1000,47,26)
}
x
hist(x,freq=F)
gen.gamma=function(n,mu,sigma){ #gen.gamma
x=numeric(n)
k=n
for(k in 1:k){
x[k]=gen.gamma.once(n,mu,sigma)
}
}
x=gen.gamma(1000,47,26)
View(g)
f=function(x,a,b){
(b^a)*(gamma(a))^(-1)*x^(a-1)*exp(-b*x)
}
#b
g=function(x,lambda){
lambda*exp(-lambda*x)
}
x=numeric(100000)
gen.gamma=function(n,mu,sigma){ #gen.gamma
k=n
for(k in 1:k){
x[k]=gen.gamma.once(n,mu,sigma)
}
}
x=gen.gamma(1000,47,26)
x=numeric(100000)
gen.gamma=function(n,mu,sigma){ #gen.gamma
replicate(n,gen.gamma(n,mu,sigma))
}
x=replicate(100,gen.gamma(n,mu,sigma))
x=replicate(100,gen.gamma(1000,47,26))
x=replicate(3,gen.gamma(1000,47,26))
a
1
A
A=cbind(c(1,1),c(1,-1))
A
install.packages("nycflights13") #Only include if the package hasn't already been installed
1
install.packages("nycflights13") #Only include if the package hasn't already been installed
library(ggplot2)
library(nycflights13)
print("Well done!  You've loaded the libraries")
install.packages("nycflights13") #Only include if the package hasn't already been installed
install.packages("nycflights13") #Only include if the package hasn't already been installed
install.packages("nycflights13") #Only include if the package hasn't already been installed
1
install.packages("nycflights13") #Only include if the package hasn't already been installed
install.packages("nycflights13") #Only include if the package hasn't already been installed
nycflights13
install.packages("nycflights13") #Only include if the package hasn't already been installed
library(ggplot2)
1
library(nycflights13)
install.packages("nycflights13") #Only include if the package hasn't already been installed
install.packages("nycflights13") #Only include if the package hasn't already been installed
#das_lab_1
install.packages("ggplot2") #Only include if the package hasn't already been installed
library(ggplot2)
install.packages("nycflights13") #Only include if the package hasn't already been installed
install.packages("nycflights13") #Only include if the package hasn't already been installed
install.packages("nycflights13") #Only include if the package hasn't already been installed
library(R2OpenBUGS)
model{{
model{{
theta~dunif(0,1)
}
model{
theta~dunif(0,1)
}
model{theta~dunif(0,1)}
#HW2_problem 4
nsamp=100000
theta=rbeta(nsamp,17,5)
mean(theta>0.5&theta<0.7)
mean(theta)
quantile(theta,probs=c(0.025,0.975))  # 95% central posterior
library(ggplot2)
install.packages("nycflights13") #Only include if the package hasn't already been installed
1
library(ggplot2)
install.packages("nycflights13") #Only include if the package hasn't already been installed
print("Well done!  You've loaded the libraries")
install.packages("nycflights13") #Only include if the package hasn't already been installed
library(nycflights13)
library(nycflights13)
install.packages("nycflights13") #Only include if the package hasn't already been installed
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE, comment = NA)
model=lm(Hwt~Sex,data=cats)
g(pi)=log(pi1âˆ’pi),
###
library(tidyverse)
library(moderndive)
library(gapminder)
library(sjPlot)
library(stats)
library(jtools)
eval.gender=evals%>%select(gender,age)
eval.gender
#ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹agebyçš„ç®±çº¿å›¾ï¼Œgenderä»¥è·å¾—å¯¹æ•°æ®çš„åˆæ­¥å°è±¡ï¼š
ggplot(data=evals.gender,aes(x=gender,y=age,fill=gender))+
geom_boxplot()+
labs(x="Gender",y="Age")+
theme(legend.position="non")
evals.gender=evals%>%select(gender,age)
evals.gender
#ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹agebyçš„ç®±çº¿å›¾ï¼Œgenderä»¥è·å¾—å¯¹æ•°æ®çš„åˆæ­¥å°è±¡ï¼š
ggplot(data=evals.gender,aes(x=gender,y=age,fill=gender))+
geom_boxplot()+
labs(x="Gender",y="Age")+
theme(legend.position="non")
#å¯¹æ•°èµ”ç‡
#ä¸ºäº†æ‹Ÿåˆé€»è¾‘å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¹¿ä¹‰çº¿æ€§æ¨¡å‹å‡½æ•°glmï¼Œå…¶ä½œç”¨æ–¹å¼ä¸lmæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„å‡½æ•°éå¸¸ç›¸ä¼¼ã€‚æˆ‘ä»¬åªéœ€è¦å¤„ç†ä¸€ä¸ªé¢å¤–çš„å‚æ•°ã€‚ä»¥æ€§åˆ«ä¸ºå“åº”ï¼Œä»¥å¹´é¾„ä¸ºè§£é‡Šå˜é‡çš„é€»è¾‘å›å½’æ¨¡å‹ç”±ä¸‹å¼ç»™å‡ºï¼š
model=glm(gender~age,data=evals,gender,
family=binomial(link="logit"))
#å¯¹æ•°èµ”ç‡
#ä¸ºäº†æ‹Ÿåˆé€»è¾‘å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¹¿ä¹‰çº¿æ€§æ¨¡å‹å‡½æ•°glmï¼Œå…¶ä½œç”¨æ–¹å¼ä¸lmæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„å‡½æ•°éå¸¸ç›¸ä¼¼ã€‚æˆ‘ä»¬åªéœ€è¦å¤„ç†ä¸€ä¸ªé¢å¤–çš„å‚æ•°ã€‚ä»¥æ€§åˆ«ä¸ºå“åº”ï¼Œä»¥å¹´é¾„ä¸ºè§£é‡Šå˜é‡çš„é€»è¾‘å›å½’æ¨¡å‹ç”±ä¸‹å¼ç»™å‡ºï¼š
model <- glm(gender ~ age, data = evals.gender,
family = binomial(link = "logit"))
#è¿™é‡Œæˆ‘ä»¬åŒ…å«äº†é™„åŠ familyå‚æ•°ï¼Œå®ƒè¯´æ˜äº†æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„åˆ†å¸ƒå’Œé“¾æ¥å‡½æ•°ã€‚å› æ­¤ï¼Œfamily = binomial(link = "logit")æˆ‘ä»¬æœ‰ä¸€ä¸ªäºŒå…ƒå“åº”å˜é‡ï¼Œå› æ­¤æœ‰ä¸€ä¸ªäºŒé¡¹å¼åˆ†å¸ƒï¼ŒåŠå…¶ç›¸åº”çš„logit é“¾æ¥å‡½æ•°ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„é€»è¾‘å›å½’æ¨¡å‹äº§ç”Ÿçš„æ€»ç»“ï¼š
model%>%summary()
#ä¸€ä¸ªæ›¿ä»£æ–¹æ³•summary()æ˜¯åŒ…ä¸­çš„summ()å‡½æ•°ï¼Œå®ƒå…è®¸å¯¹æ±‡æ€»è¡¨ä¸­åŒ…å«çš„å†…å®¹è¿›è¡Œæ›´å¤šæ§åˆ¶ï¼Œå¹¶æä¾›æ›´å¥½çš„æ ¼å¼è¾“å‡ºã€‚è¿™æ˜¯ä¸Šé¢æ‹Ÿåˆæ¨¡å‹çš„é»˜è®¤è¾“å‡º......jtools
summ(model)
#ä¸ºäº†è§£é‡Šè¿™ä¸ªæ‹Ÿåˆæ¨¡å‹ï¼Œé¦–å…ˆæˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬çš„äºŒå…ƒå“åº”çš„åŸºçº¿ç±»åˆ«æ˜¯femaleã€‚è¿™æ˜¯å› ä¸º R ä¸­çš„é»˜è®¤åŸºçº¿è¢«è§†ä¸ºæŒ‰å­—æ¯é¡ºåºæ’åœ¨ç¬¬ä¸€ä½çš„åŸºçº¿ï¼Œè¿™å¯ä»¥ä»levelså‡½æ•°ä¸­çœ‹å‡ºï¼š
levels(evals.gender$gender)
mod1coefs <- round(coef(model), 2)
mod1coefs
confint(model) %>%
kable()
confint(model) %>%
knitr::kable()
mod.coef.logodds <- model %>%
summary() %>%
coef()
age.logodds.lower <- mod.coef.logodds["age", "Estimate"] -
1.96 * mod.coef.logodds["age", "Std. Error"]
age.logodds.lower
age.logodds.upper <- mod.coef.logodds["age", "Estimate"] +
1.96 * mod.coef.logodds["age", "Std. Error"]
mod.coef.logodds["age", "Estimate"]
confint(model) %>%
knitr::kable()
mod.coef.logodds["age", "Estimate"] -
1.96 * mod.coef.logodds["age", "Std. Error"]
#å› æ­¤ï¼Œå¯¹æ•°ä¼˜åŠ¿çš„ç‚¹ä¼°è®¡å€¼ä¸º 0.06ï¼Œç›¸åº”çš„ 95% ç½®ä¿¡åŒºé—´ä¸º (0.04, 0.08)ã€‚è¿™å¯ä»¥ä½¿ç”¨åŒ…ä¸­çš„plot_modelå‡½æ•°ä»¥å›¾å½¢æ–¹å¼æ˜¾ç¤ºsjPlotï¼Œåªéœ€å°† ourmodelä½œä¸ºå‚æ•°ä¼ é€’ï¼š
plot_model(model, show.values = TRUE, transform = NULL,
title = "Log-Odds (Male instructor)", show.p = FALSE)
evals.gender
evals.gender <- evals.gender %>%
mutate(logodds.male = predict(model))
evals.gender
evals.gender %>%
mutate(logodds.male = predict(model))
%>%
#ç£·1 - p=ç»éªŒ( Î± + Î²â‹…å¹´é¾„) ,
model %>%
coef() %>%
exp()
model %>%
coef()
model %>%
coef() %>%
exp()
age.odds.lower <- exp(age.logodds.lower)
age.odds.lower
age.odds.upper <- exp(age.logodds.upper)
age.odds.upper
#å› æ­¤ï¼Œèµ”ç‡çš„ç‚¹ä¼°è®¡å€¼ä¸º 1.06ï¼Œç›¸åº”çš„ 95% ç½®ä¿¡åŒºé—´ä¸º (1.04, 1.09)ã€‚è¿™å¯ä»¥ä½¿ç”¨åŒ…ä¸­çš„plot_modelå‡½æ•°ä»¥å›¾å½¢æ–¹å¼æ˜¾ç¤ºsjPlotï¼Œåªéœ€å°† ourmodelä½œä¸ºå‚æ•°ä¼ é€’å¹¶åˆ é™¤transform = NULLï¼ˆé»˜è®¤è½¬æ¢æ˜¯æŒ‡æ•°è½¬æ¢ï¼‰
plot_model(model, show.values = TRUE, axis.lim = c(1,1.5),
title = "Odds (Male instructor)", show.p = FALSE)
model
#ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†å‡ ç‡çš„ä¼°è®¡æ·»åŠ åˆ°æˆ‘ä»¬çš„æ•°æ®é›†ä¸­ï¼š
evals.gender <- evals.gender %>%
mutate(odds.male = exp(logodds.male))
p.num <- exp(mod.coef.logodds["(Intercept)", "Estimate"] + mod.coef.logodds["age", "Estimate"] * 52)
p.denom <- 1 + p.num
p.num / p.denom
#åº“ä¸­çš„plogis()å‡½æ•°statsä¹Ÿå¯ç”¨äºä»å¯¹æ•°èµ”ç‡ä¸­è·å–æ¦‚ç‡ï¼š
plogis(mod.coef.logodds["(Intercept)", "Estimate"] + mod.coef.logodds["age", "Estimate"] * 52)
#è®©æˆ‘ä»¬å°†æ¦‚ç‡æ·»åŠ åˆ°æˆ‘ä»¬çš„æ•°æ®ä¸­ï¼Œè¿™æ˜¯ä½¿ç”¨fitted()å‡½æ•°å®Œæˆçš„ï¼š
evals.gender <- evals.gender %>%
mutate(probs.male = fitted(model))
evals.gender
ggplot(data = evals.gender, aes(x = age, y = probs.male)) +
geom_smooth(method="glm",
method.args = list(family="binomial"),
se = FALSE) +
labs(x = "Age", y = "Probability of instructor being male")
#åŒ…ä¸­çš„plot_model()å‡½æ•°sjPlotè¿˜å¯ä»¥é€šè¿‡ageå¦‚ä¸‹æ–¹å¼äº§ç”Ÿä¼°è®¡æ¦‚ç‡ï¼š
plot_model(model, type = "pred", title = "",
axis.title = c("Age", "Prob. of instructor being male"))
#å…·æœ‰ä¸€ä¸ªåˆ†ç±»è§£é‡Šå˜é‡çš„äºŒå…ƒé€»è¾‘å›å½’
#ageç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨äºŒè¿›åˆ¶åˆ†ç±»å˜é‡ethnicityä½œä¸ºæˆ‘ä»¬çš„è§£é‡Šå˜é‡ï¼Œè€Œä¸æ˜¯åƒ é‚£æ ·ä½¿ç”¨æ•°å€¼è§£é‡Šå˜é‡ã€‚
evals.ethnic <- evals %>%
select(gender, ethnicity)
evals.ethnic
evals %>%
tabyl(ethnicity, gender)
#æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬ 7 å‘¨ä¸­é¦–æ¬¡çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥janitoråŒ…ä»¥è¡¨æ ¼æ ¼å¼æ±‡æ€»è¿™äº›æ•°æ®ï¼š
evals %>%
tabyl(ethnicity, gender) %>%
adorn_percentages() %>%
adorn_pct_formatting() %>%
adorn_ns() # To show original counts
#æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬ 7 å‘¨ä¸­é¦–æ¬¡çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥janitoråŒ…ä»¥è¡¨æ ¼æ ¼å¼æ±‡æ€»è¿™äº›æ•°æ®ï¼š
library(janitor)
evals %>%
tabyl(ethnicity, gender)
evals %>%
tabyl(ethnicity, gender) %>%
adorn_percentages()
evals %>%
tabyl(ethnicity, gender) %>%
adorn_percentages() %>%
adorn_pct_formatting()
evals %>%
tabyl(ethnicity, gender) %>%
adorn_percentages() %>%
adorn_pct_formatting() %>%
adorn_ns()
ggplot(evals, aes(x= gender,  y = ..prop.., group=ethnicity, fill=ethnicity)) +
geom_bar(position="dodge", stat="count") +
labs(y = "Proportion")
ggplot(evals, aes(x= gender,  y = ..prop.., group=ethnicity, fill=ethnicity))
ggplot(evals, aes(x= gender,  y = ..prop.., group=ethnicity, fill=ethnicity)) +
geom_bar(position="dodge", stat="count")
ggplot(evals, aes(x= gender,  y = ..prop.., group=ethnicity, fill=ethnicity))
..prop..
ggplot(evals, aes(x= gender,  y = ..prop.., group=ethnicity, fill=ethnicity))
#å¯¹æ•°èµ”ç‡
#é€»è¾‘å›å½’æ¨¡å‹ç”±ä¸‹å¼ç»™å‡ºï¼š
model.ethnic <- glm(gender ~ ethnicity, data = evals.ethnic, family = binomial(link = "logit"))
model.ethnic %>%
summary()
levels(evals.ethnic$ethnicity)
confint(model.ethnic) %>%
knitr::kable()
mod.ethnic.coef.logodds <- model.ethnic %>%
summary() %>%
coef()
ethnic.logodds.lower <- mod.ethnic.coef.logodds["ethnicitynot minority", "Estimate"] -
1.96 * mod.ethnic.coef.logodds["ethnicitynot minority", "Std. Error"]
#[1] 0.1300587
ethnic.logodds.upper <- mod.ethnic.coef.logodds["ethnicitynot minority", "Estimate"] +
1.96 * mod.ethnic.coef.logodds["ethnicitynot minority", "Std. Error"]
plot_model(model.ethnic, show.values = TRUE, transform = NULL,
title = "Log-Odds (Male instructor)", show.p = FALSE)
#  Oddsnot minorityOddsminority=pnot minority1âˆ’pnot minoritypminority1âˆ’pminority=exp(Î±+Î²)exp(Î±)=exp(Î±+Î²âˆ’Î±)=exp(Î²)=exp(0.66)=1.93.
# the number of instructors not in the minority
pnotmin <- evals.ethnic %>%
filter(ethnicity == "not minority") %>%
summarize(n()) %>%
pull()
# the number of male instructors not in the minority
pnotmin.male <- evals.ethnic %>%
filter(ethnicity == "not minority", gender == "male") %>%
summarize(n()) %>%
pull()
# the proportion/probability of males not in the minority
prob.notmin.male <- pnotmin.male / pnotmin
odds.notmin.male <- prob.notmin.male / (1 - prob.notmin.male)
odds.ratio.notmin <- odds.notmin.male / odds.min.male
pmin <- evals.ethnic %>%
filter(ethnicity == "minority") %>%
summarize(n()) %>%
pull()
# the number of male instructors in the minority
pmin.male <- evals.ethnic %>%
filter(ethnicity == "minority", gender == "male") %>%
summarize(n()) %>%
pull()
# the proportion/probability of males in the minority
prob.min.male <- pmin.male / pmin
odds.min.male <- prob.min.male / (1 - prob.min.male)
odds.min.male
pnotmin <- evals.ethnic %>%
filter(ethnicity == "not minority") %>%
summarize(n()) %>%
pull()
# the number of male instructors not in the minority
pnotmin.male <- evals.ethnic %>%
filter(ethnicity == "not minority", gender == "male") %>%
summarize(n()) %>%
pull()
# the proportion/probability of males not in the minority
prob.notmin.male <- pnotmin.male / pnotmin
odds.notmin.male <- prob.notmin.male / (1 - prob.notmin.male)
odds.ratio.notmin <- odds.notmin.male / odds.min.male
ethnic.odds.lower <- exp(ethnic.logodds.lower)
#[1] 1.138895
ethnic.odds.upper <- exp(ethnic.logodds.upper)
plot_model(model.ethnic, show.values = TRUE,
title = "Odds (Male instructor)", show.p = FALSE)
evals.ethnic <- evals.ethnic %>%
mutate(odds.male = exp(logodds.male))
plogis(mod.ethnic.coef.logodds["(Intercept)", "Estimate"])
plogis(mod.ethnic.coef.logodds["(Intercept)", "Estimate"] +
mod.ethnic.coef.logodds["ethnicitynot minority", "Estimate"])
mod.ethnic.coef.logodds["(Intercept)", "Estimate"] +
mod.ethnic.coef.logodds["ethnicitynot minority", "Estimate"]
mod.ethnic.coef.logodds
plogis(mod.ethnic.coef.logodds["(Intercept)", "Estimate"] +
mod.ethnic.coef.logodds["ethnicitynot minority", "Estimate"])
mod.ethnic.coef.logodds["(Intercept)", "Estimate"]
#æ¦‚ç‡
#è€ƒè™‘åˆ°ä»–ä»¬åœ¨minorityå’Œnot minorityå°ç»„ä¸­ï¼Œä¸€åæ•™å¸ˆæ˜¯ç”·æ€§çš„æ¦‚ç‡æ˜¯
?plogis
mod.ethnic.coef.logodds
mod.ethnic.coef.logodds["(Intercept)", "Estimate"]
evals.ethnic <- evals.ethnic %>%
mutate(probs.male = fitted(model.ethnic))
plot_model(model.ethnic, type = "pred", title = "",
axis.title = c("Ethnicity", "Prob. of instructor being male"))
#ä¸‹è½½æ•°æ®ï¼ˆyanny.csvä»Moodleçš„ï¼‰å’Œé€‚åˆé€»è¾‘å›å½’æ¨¡å‹ä¸hearä½œä¸ºäºŒå…ƒå“åº”å˜é‡ï¼Œageå’Œgenderä½œä¸ºè§£é‡Šå˜é‡ã€‚ä½ çš„å‘ç°æ˜¯ä»€ä¹ˆï¼Ÿ
setwd("/Users/kurisuuu/Documents/glasgow_stats_2021/semester\ 2/das")
yanny=read.csv("yanna.csv")
yanny=read.csv("yanny.csv")
#ä¸‹è½½æ•°æ®ï¼ˆyanny.csvä»Moodleçš„ï¼‰å’Œé€‚åˆé€»è¾‘å›å½’æ¨¡å‹ä¸hearä½œä¸ºäºŒå…ƒå“åº”å˜é‡ï¼Œageå’Œgenderä½œä¸ºè§£é‡Šå˜é‡ã€‚ä½ çš„å‘ç°æ˜¯ä»€ä¹ˆï¼Ÿ
setwd("/Users/kurisuuu/Documents/glasgow_stats_2021/semester\ 2/das")
#ä¸‹è½½æ•°æ®ï¼ˆyanny.csvä»Moodleçš„ï¼‰å’Œé€‚åˆé€»è¾‘å›å½’æ¨¡å‹ä¸hearä½œä¸ºäºŒå…ƒå“åº”å˜é‡ï¼Œageå’Œgenderä½œä¸ºè§£é‡Šå˜é‡ã€‚ä½ çš„å‘ç°æ˜¯ä»€ä¹ˆï¼Ÿ
setwd("/Users/kurisuuu/Documents/glasgow_stats_2021/semester\ 2/das/Week\ 9\ Data\ For\ Further\ Tasks")
#ä¸‹è½½æ•°æ®ï¼ˆyanny.csvä»Moodleçš„ï¼‰å’Œé€‚åˆé€»è¾‘å›å½’æ¨¡å‹ä¸hearä½œä¸ºäºŒå…ƒå“åº”å˜é‡ï¼Œageå’Œgenderä½œä¸ºè§£é‡Šå˜é‡ã€‚ä½ çš„å‘ç°æ˜¯ä»€ä¹ˆï¼Ÿ
setwd("/Users/kurisuuu/Documents/glasgow_stats_2021/semester\ 2/das/Week\ 9\ Data\ For\ Further\ Tasks-20210706")
yanny=read.csv("yanny.csv")
yanny=yanny%>%
select(hear,gender,age)
yanny$hear=as.factor(yanny$hear)
yanny$gender=as.factor(yanny$gender)
ggplot(data=yanny,aes(x=hear,y=age,fill=hear))+
geom_boxplot()+
labs(x="what do you hear?",y="Age")+
theme(legend.position="none")
#We see in the boxplot that the people who hear Yanny are, on average, younger, however there is some
#overlap in the IQRâ€™s.
yanny%>%tabyl(gender,hear)%>%adorn_percentages()%>%adorn_pct_formatting()%>%adorn_ns()
ggplot(data = yanny, aes(x = hear, group = gender)) +
geom_bar(aes(y = ..prop.., fill = gender), stat = "count", position = "dodge") +
labs(x = "What do you hear?", y = "Proportion")
#There is a slightly smaller proportion of men hearing Yanny, but the proportions are very similar overall.
mod.yanny <- glm(hear ~ age + gender, data = yanny, family = binomial(link = "logit"))
mod.yanny %>%
summary()
#There is a slightly smaller proportion of men hearing Yanny, but the proportions are very similar overall.
mod.yanny <- glm(hear ~ age + gender, data = yanny, family = binomial(link = "logit"))
mod.yanny %>%
summary()
mod.yanny <- glm(hear ~ age, data = yanny, family = binomial(link = "logit"))
mod.yanny %>%
summary()
#Notice that the coefficient of age is negative, suggesting that older people are less likely to hear Yanny.
#However, the coefficient of age is not significant (ğ‘-value of 0.16). Still, if we wanted to use the estimated
#coefficient to quantify the effect of age, we would need to look at exp(-0.04812) = 0.953. This suggests that
#for two people who differ by one year in age, the older personâ€™s odds of hearing Yanny are 0.953 times those
#of the younger person. If we want to look at a ten-year age difference then the odds multiplier becomes
#exp(0.04812 * 10) = 1.618. Hence, for two people who differ by 10 years in age, the older personâ€™s odds of
#hearing Yanny are 1.618 times those of the younger person.
plot_model(mod.yanny, show.values = TRUE,
title = "Odds (Age)", show.p = TRUE)
plot_model(mod.yanny, type = "pred", title = "",
axis.title = c("Age", "Probability of hearing Yanny"))
#Download the data (titanic.csv) from Moodle for ğ‘› = 891 passengers aboard the Titanic and fit a logistic
#regression model with survived as the binary response variable, and age, gender, and passenger.class
#as the explanatory variables. What are your findings?
titanic <- read_csv("titanic.csv")
titanic <- titanic %>%
select(survived, age, gender, passenger.class)
titanic$survived <- as.factor(titanic$survived)
levels(titanic$survived) <- c("Died", "Survived")
titanic$gender <- as.factor(titanic$gender)
titanic$passenger.class <- as.factor(titanic$passenger.class)
ggplot(data = titanic, aes(x = survived, y = age, fill = survived)) +
geom_boxplot() +
labs(x = "Survived the Titanic?", y = "Age") +
theme(legend.position = "none")
titanic %>%
tabyl(gender, survived) %>%
adorn_percentages() %>%
adorn_pct_formatting() %>%
adorn_ns() # To show original counts
ggplot(data = titanic, aes(x = survived, group = gender)) +
geom_bar(aes(y = ..prop.., fill = gender), stat = "count", position = "dodge") +
labs(x = "Survived the Titanic?", y = "Proportion")
titanic %>%
tabyl(passenger.class, survived) %>%
adorn_percentages() %>%
adorn_pct_formatting() %>%
adorn_ns() # To show original counts
ggplot(data = titanic, aes(x = survived, group = passenger.class)) +
geom_bar(aes(y = ..prop.., fill = passenger.class),
stat = "count", position = "dodge") +
labs(x = "Survived the Titanic?", y = "Proportion")
plot_model(mod.titanic, show.values = TRUE,
title = "", show.p = FALSE, value.offset = 0.25)
#The largest group of passengers who died were third class passengers, while among those who survived the
#largest group was first class passengers.
mod.titanic <- glm(survived ~ gender + passenger.class + age, data = titanic,
family = binomial(link = "logit"))
mod.titanic %>%
summary()
plot_model(mod.titanic, show.values = TRUE,
title = "", show.p = FALSE, value.offset = 0.25)
install.packages("nimble") ## Install nimble
## nimble is an R package, which can do everything that WinBUGS does
## For further information about nimble, see https://r-nimble.org/
## User manual can be found here: https://r-nimble.org/documentation-2
##
library(nimble)
## Data
x <- c(1.6907, 1.7242, 1.7552, 1.7842, 1.8113, 1.8369, 1.8610, 1.8839)
n <- c(59, 60, 62, 56, 63, 59, 62, 60)
y <- c(6, 13, 18, 28, 52, 53, 61, 60)
N <- length(y)
## Model 1: use the WinBUGS model code directly
code1 <- nimbleCode({
for (j in 1:N) {
y[j] ~ dbin(theta[j], n[j])
logit(theta[j]) <- alpha + beta * x[j]
yhat[j] <- n[j] * theta[j]
}
alpha ~ dnorm(0.0, tau = 1e-6)
beta  ~ dnorm(0.0, tau = 1e-6)
})
## Initial values, data and constants
consts <- list(N = N, x = x, n = n)
inits<- list(alpha = 0, beta = 0)
data <- list(y = y)
## Build nimble model
model1 <- nimbleModel(code = code1, constants = consts, data = data, inits = inits)
## Compile the model
Cmodel1 <- compileNimble(model1)
## Set up to generate posterior samples
monitors1 <- c("alpha", "beta")
